<UserControl x:Class="DXVisualTestFixer.Views.MainView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:DXVisualTestFixer.Views"
             xmlns:mif="clr-namespace:DXVisualTestFixer.Mif"
             xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxdo="http://schemas.devexpress.com/winfx/2008/xaml/docking"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:controls="clr-namespace:DXVisualTestFixer.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <UserControl.Resources>
        <Style TargetType="{x:Type dxe:ComboBoxEdit}">
            <Setter Property="Margin" Value="4"/>
        </Style>
        <Style TargetType="{x:Type Button}">
            <Setter Property="Margin" Value="4"/>
        </Style>
    </UserControl.Resources>
    <dxmvvm:Interaction.Behaviors>
        <dxmvvm:UIWindowRegion x:Name="settingsService" RegionName="{x:Static mif:Regions.Settings}" WindowShowMode="Dialog" SetWindowOwner="True">
            <dxmvvm:UIWindowRegion.WindowFactory>
                <DataTemplate>
                    <dx:DXDialogWindow/>
                </DataTemplate>
            </dxmvvm:UIWindowRegion.WindowFactory>
            <dxmvvm:UIWindowRegion.WindowStyle>
                <Style TargetType="dx:DXDialogWindow">
                    <Setter Property="Width" Value="1000"/>
                    <Setter Property="Height" Value="800"/>
                    <Setter Property="Title" Value="Settings"/>
                    <Setter Property="CommandsSource" Value="{Binding DialogCommands}"/>
                </Style>
            </dxmvvm:UIWindowRegion.WindowStyle>
        </dxmvvm:UIWindowRegion>
        <dx:DXMessageBoxService x:Name="messageBoxService"/>
        <dxmvvm:UIWindowRegion x:Name="applyChangesService" RegionName="{x:Static mif:Regions.ApplyChanges}" WindowShowMode="Dialog" SetWindowOwner="True">
            <dxmvvm:UIWindowRegion.WindowFactory>
                <DataTemplate>
                    <dx:DXDialogWindow/>
                </DataTemplate>
            </dxmvvm:UIWindowRegion.WindowFactory>
            <dxmvvm:UIWindowRegion.WindowStyle>
                <Style TargetType="dx:DXDialogWindow">
                    <Setter Property="Width" Value="1000"/>
                    <Setter Property="Height" Value="800"/>
                    <Setter Property="Title" Value="Changed Tests"/>
                    <Setter Property="CommandsSource" Value="{Binding DialogCommands}"/>
                </Style>
            </dxmvvm:UIWindowRegion.WindowStyle>
        </dxmvvm:UIWindowRegion>
    </dxmvvm:Interaction.Behaviors>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <dxr:RibbonControl RibbonStyle="Office2010" ToolbarShowMode="Hide" AllowCustomization="False" MinimizationButtonVisibility="Collapsed" RibbonHeaderVisibility="Collapsed">
            <dxr:RibbonDefaultPageCategory>
                <dxr:RibbonPage Caption="Main">
                    <dxr:RibbonPageGroup Caption="Work">
                        <dxb:BarButtonItem RibbonStyle="Large" 
                                           GlyphSize="Large" 
                                           Content="Update Tests"
                                           KeyGesture="F5" dxb:BarManager.KeyGestureWorkingMode="AllKeyGesture"
                                           Command="{DXCommand Execute='RefreshTestList()'}"
                                           LargeGlyph="{dx:DXImageOffice2013 Image=Refresh_32x32.png}">
                        </dxb:BarButtonItem>
                        <dxb:BarButtonItem
                            RibbonStyle="Large" 
                            GlyphSize="Large" 
                            Content="Apply Changes"
                            Command="{DXCommand Execute='ApplyChanges()'}"
                            LargeGlyph="{dx:DXImageOffice2013 Image=Apply_32x32.png}">
                        </dxb:BarButtonItem>
                    </dxr:RibbonPageGroup>
                    <dxr:RibbonPageGroup Caption="Settings">
                        <dxb:BarButtonItem
                            RibbonStyle="Large" 
                            GlyphSize="Large" 
                            Content="Settings"
                            Command="{DXCommand Execute='ShowSettings()'}"
                            LargeGlyph="{dx:DXImageOffice2013 Image=Properties_32x32.png}">
                        </dxb:BarButtonItem>
                    </dxr:RibbonPageGroup>
                </dxr:RibbonPage>
            </dxr:RibbonDefaultPageCategory>
        </dxr:RibbonControl>
        <dxdo:DockLayoutManager Grid.Row="1">
            <dxdo:LayoutGroup AllowDrag="False">
                <dxdo:LayoutPanel ShowCaption="False" ItemWidth="300">
                    <dxg:GridControl ItemsSource="{Binding Tests}" CurrentItem="{Binding CurrentTest, Mode=TwoWay}" AutoExpandAllGroups="True" ShowBorder="False">
                        <dxg:GridColumn FieldName="Version" GroupIndex="0" MergeWithPreviousGroup="True"/>
                        <dxg:GridColumn FieldName="Team.Name" GroupIndex="1" MergeWithPreviousGroup="True"/>
                        <dxg:GridColumn FieldName="Name" GroupIndex="2" MergeWithPreviousGroup="True"/>
                        <dxg:GridColumn FieldName="Theme" Width="*">
                            <dxg:GridColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <dxe:TextEdit x:Name="PART_Editor"/>
                                        <dxe:TextEdit EditMode="InplaceInactive" Margin="2,0,0,0">
                                            <dxe:TextEdit.EditValue>
                                                <Binding Path="RowData.Row.Optimized">
                                                    <Binding.Converter>
                                                        <dxmvvm:ObjectToObjectConverter DefaultSource="False" DefaultTarget="{x:Null}">
                                                            <dxmvvm:MapItem Source="True" Target="(optimized)"/>
                                                        </dxmvvm:ObjectToObjectConverter>
                                                    </Binding.Converter>
                                                </Binding>
                                            </dxe:TextEdit.EditValue>
                                        </dxe:TextEdit>
                                    </StackPanel>
                                </DataTemplate>
                            </dxg:GridColumn.CellTemplate>
                        </dxg:GridColumn>
                        <dxg:GridControl.TotalSummary>
                            <dxg:GridSummaryItem SummaryType="Count" Alignment="Left"/>
                        </dxg:GridControl.TotalSummary>
                        <dxg:GridControl.View>
                            <controls:TableViewAdvNavigation AllowEditing="False" ShowVerticalLines="False" ShowIndicator="False" ShowHorizontalLines="False" ShowColumnHeaders="False" ShowGroupPanel="False" 
                                           ShowFixedTotalSummary="True">
                                <dxmvvm:Interaction.Behaviors>
                                    <dxmvvm:EventToCommand EventName="MoveNext" Command="{DXCommand Execute='@s.AssociatedObject.MoveNextDataRow()'}" SourceObject="{Binding}"/>
                                    <dxmvvm:EventToCommand EventName="MovePrev" Command="{DXCommand Execute='@s.AssociatedObject.MovePrevDataRow()'}" SourceObject="{Binding}"/>
                                </dxmvvm:Interaction.Behaviors>
                                <controls:TableViewAdvNavigation.FormatConditions>
                                    <dxg:FormatCondition FieldName="CommitChange" ValueRule="Equal" Value1="True" PredefinedFormatName="GreenFillWithDarkGreenText" ApplyToRow="True"/>
                                </controls:TableViewAdvNavigation.FormatConditions>
                            </controls:TableViewAdvNavigation>
                        </dxg:GridControl.View>
                    </dxg:GridControl>
                </dxdo:LayoutPanel>
                <dxdo:LayoutPanel dxmvvm:UIRegion.Region="{x:Static mif:Regions.TestInfo}" ShowCaption="False"/>
            </dxdo:LayoutGroup>
        </dxdo:DockLayoutManager>
        <dxr:RibbonStatusBarControl Grid.Row="2" IsSizeGripVisible="True">
            <dxr:RibbonStatusBarControl.RightItems>
                <dxb:BarStaticItem Content="Status" AutoSizeMode="None"/>
            </dxr:RibbonStatusBarControl.RightItems>
        </dxr:RibbonStatusBarControl>
    </Grid>
</UserControl>
